datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch"]
}

generator typegraphql {
  provider = "typegraphql-prisma"
  output   = "../src/generatedGraphql"
}

model Post {
  id        Int      @id @default(autoincrement())
  title     String   @db.VarChar(255)
  createdAt DateTime @default(now()) @db.Timestamp(6)
  content   String?
  published Boolean  @default(false)
  authorId  Int
  author    User     @relation(fields: [authorId], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Profile {
  id     Int     @id @default(autoincrement())
  bio    String?
  userId Int     @unique
  user   User    @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

enum Rating {
  high
  medium
  low
}

model Review {
  id           Int      @id @default(autoincrement())
  rating       Rating
  text         String
  userId       Int
  creationDate DateTime
  editDate     DateTime
  author       User     @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  foodId       Int
  food         Food     @relation(fields: [foodId], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

enum Location {
  UCLA
}

enum FoodCategory {
  soda
  sandwich
  pizza
  salad
}

model Food {
  id            Int          @id @default(autoincrement())
  reviews       Review[]
  images        String[]
  location      Location
  type          FoodCategory
  usersWithFavs User[]       @relation("usersWithFavs")
  usersWantTry  User[]       @relation("usersWantTry")
}

model User {
  id            Int      @id @default(autoincrement())
  // We don't need the firebase ID to be accessable over the API
  /// @TypeGraphQL.omit(output: true, input: true)
  firebaseId    String   @unique
  name          String?  @db.VarChar(255)
  email         String   @unique @db.VarChar(255) // May not need it, firebase might handle
  posts         Post[]
  reviews       Review[]
  profile       Profile?
  favoritesList Food[]   @relation("usersWithFavs")
  toTryList     Food[]   @relation("usersWantTry")
}
